{"version":3,"sources":["server/middleware/reactApplication/getClientBundleEntryAssets.js"],"names":["fs","resolve","pathResolve","appRootDir","getConfig","resultCache","getClientBundleEntryAssets","process","env","NODE_ENV","assetsFilePath","get","existsSync","Error","readAssetsJSONFile","JSON","parse","readFileSync","assetsJSONCache","index"],"mappings":"AAAA;;;;AAIA,OAAOA,EAAP,MAAe,IAAf;AACA,SAASC,WAAWC,WAApB,QAAuC,MAAvC;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,OAAOC,SAAP,MAAsB,qBAAtB;;AAEA,IAAIC,WAAJ;;AAEA;;;;;;;;;;;;;AAaA,eAAe,SAASC,0BAAT,GAAsC;AACnD;AACA;AACA;AACA,MAAIC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,aAAzB,IAA0CJ,WAA9C,EAA2D;AACzD,WAAOA,WAAP;AACD;;AAED,QAAMK,iBAAiBR,YACrBC,WAAWQ,GAAX,EADqB,EAErBP,UAAU,2BAAV,CAFqB,EAGpB,KAAIA,UAAU,sBAAV,CAAkC,EAHlB,CAAvB;;AAMA,MAAI,CAACJ,GAAGY,UAAH,CAAcF,cAAd,CAAL,EAAoC;AAClC,UAAM,IAAIG,KAAJ,CACH,0BAAyBH,cAAe,yHADrC,CAAN;AAGD;;AAED,QAAMI,qBAAqB,MAAMC,KAAKC,KAAL,CAAWhB,GAAGiB,YAAH,CAAgBP,cAAhB,EAAgC,MAAhC,CAAX,CAAjC;AACA,QAAMQ,kBAAkBJ,oBAAxB;AACA,MAAI,OAAOI,gBAAgBC,KAAvB,KAAiC,WAArC,EAAkD;AAChD,UAAM,IAAIN,KAAJ,CAAU,wEAAV,CAAN;AACD;AACDR,gBAAca,gBAAgBC,KAA9B;AACA,SAAOd,WAAP;AACD","file":"getClientBundleEntryAssets.js","sourceRoot":"/Users/Adam/Dev/listman","sourcesContent":["/**\n * This file resolves the entry assets available from our client bundle.\n */\n\nimport fs from 'fs';\nimport { resolve as pathResolve } from 'path';\nimport appRootDir from 'app-root-dir';\nimport getConfig from '../../../config/get';\n\nlet resultCache;\n\n/**\n * Retrieves the js/css for the named chunks that belong to our client bundle.\n *\n * Note: the order of the chunk names is important. The same ordering will be\n * used when rendering the scripts.\n *\n * This is useful to us for a couple of reasons:\n *   - It allows us to target the assets for a specific chunk, thereby only\n *     loading the assets we know we will need for a specific request.\n *   - The assets are hashed, and therefore they can't be \"manually\" added\n *     to the render logic.  Having this method allows us to easily fetch\n *     the respective assets simply by using a chunk name. :)\n */\nexport default function getClientBundleEntryAssets() {\n  // Return the assets json cache if it exists.\n  // In development mode we always read the assets json file from disk to avoid\n  // any cases where an older version gets cached.\n  if (process.env.NODE_ENV !== 'development' && resultCache) {\n    return resultCache;\n  }\n\n  const assetsFilePath = pathResolve(\n    appRootDir.get(),\n    getConfig('bundles.client.outputPath'),\n    `./${getConfig('bundleAssetsFileName')}`,\n  );\n\n  if (!fs.existsSync(assetsFilePath)) {\n    throw new Error(\n      `We could not find the \"${assetsFilePath}\" file, which contains a list of the assets of the client bundle.  Please ensure that the client bundle has been built.`,\n    );\n  }\n\n  const readAssetsJSONFile = () => JSON.parse(fs.readFileSync(assetsFilePath, 'utf8'));\n  const assetsJSONCache = readAssetsJSONFile();\n  if (typeof assetsJSONCache.index === 'undefined') {\n    throw new Error('No asset data found for expected \"index\" entry chunk of client bundle.');\n  }\n  resultCache = assetsJSONCache.index;\n  return resultCache;\n}\n"]}